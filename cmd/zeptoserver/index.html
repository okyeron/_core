<html>

<head>
</head>

<body>
    <div id="app">
        {{ message }}
        <ul>
            <li v-for="b in banks">
                <ul>
                    <li v-for="bank in b.bank">
                        {{ bank }}
                    </li>
                </ul>
            </li>
        </ul>
    </div>
    <script src="/static/vue.js"></script>
    <script>
        // websocket in javascript
        var socket;
        const socketMessageListener = (e) => {
            console.log(e.data);
        };
        const socketOpenListener = (e) => {
            console.log('Connected');
            socket.send(JSON.stringify({ message: "hello, server" }))
        };
        const socketErrorListener = (e) => {
            console.error(e);
        }
        const socketCloseListener = (e) => {
            if (socket) {
                console.log('Disconnected.');
            }
            var url = window.origin.replace("http", "ws") + '/ws';
            socket = new WebSocket(url);
            socket.onopen = socketOpenListener;
            socket.onmessage = socketMessageListener;
            socket.onclose = socketCloseListener;
            socket.onerror = socketErrorListener;
        };
        window.addEventListener('load', (event) => {
            socketCloseListener();
        });


        var app = new Vue({
            el: '#app',
            data: {
                message: 'Hello Vue!',
                banks: [
                    {
                        bank: ['question 1.1', 'question 1.2']
                    },
                    {
                        bank: [{ name: "file2.wav" }, 'question 2.2']
                    }
                ],
            },
        })
    </script>
</body>

</html>